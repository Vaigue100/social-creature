<!DOCTYPE html>
<html>
<head>
    <title>Session Debug</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .box {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }
        .good { border-left-color: #27ae60; }
        .bad { border-left-color: #e74c3c; }
        pre {
            background: #f8f8f8;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç Session Debug Tool</h1>

    <div class="box">
        <h3>Current User:</h3>
        <div id="current-user">Loading...</div>
    </div>

    <div class="box">
        <h3>YouTube Token Status:</h3>
        <div id="youtube-status">Loading...</div>
    </div>

    <div class="box">
        <h3>Expected Accounts:</h3>
        <pre>
‚úÖ NEW account (should be logged in as):
   Email: xbarneyroddis_1763807028981@gmail.com
   ID: c68164be-42a5-4cb8-9c1a-1a8afbfa7c05

‚ùå OLD account (should NOT be this):
   Email: xbarneyroddis_1763783097928@gmail.com
   ID: c14d0e93-4a92-4597-b1a2-91a72d081f77
        </pre>
    </div>

    <script>
        async function checkSession() {
            // Check current user
            try {
                const userResponse = await fetch('/api/user/me');
                const userData = await userResponse.json();

                const isNewAccount = userData.id === 'c68164be-42a5-4cb8-9c1a-1a8afbfa7c05';
                const userDiv = document.getElementById('current-user');
                userDiv.innerHTML = `
                    <div class="${isNewAccount ? 'good' : 'bad'}">
                        <strong>Email:</strong> ${userData.email}<br>
                        <strong>ID:</strong> ${userData.id}<br>
                        <strong>Status:</strong> ${isNewAccount ? '‚úÖ NEW ACCOUNT (correct!)' : '‚ùå OLD ACCOUNT (wrong!)'}
                    </div>
                `;

                // Check YouTube status
                const youtubeResponse = await fetch('/api/youtube/token');
                const youtubeData = await youtubeResponse.json();

                const statusDiv = document.getElementById('youtube-status');
                statusDiv.innerHTML = `
                    <pre>${JSON.stringify(youtubeData, null, 2)}</pre>
                    <div class="${!youtubeData.connected ? 'good' : 'bad'}">
                        <strong>Expected for NEW account:</strong> { "connected": false }<br>
                        <strong>Actual:</strong> ${JSON.stringify(youtubeData)}<br>
                        <strong>Status:</strong> ${!youtubeData.connected ? '‚úÖ Correct (shows not connected)' : '‚ùå Wrong (shows connected)'}
                    </div>
                `;

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('current-user').innerHTML = `<div class="bad">Error: ${error.message}</div>`;
            }
        }

        checkSession();
    </script>
</body>
</html>
